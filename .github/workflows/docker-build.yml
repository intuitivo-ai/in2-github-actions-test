name: Docker-Build

on:
  workflow_call:
    outputs:
      image_id:
        value: ${{ jobs.docker-build.outputs.IMAGE_ID }}
      commit_id:
        value: ${{ jobs.docker-build.outputs.COMMIT_ID }}

jobs:
  docker-build:
    runs-on: ubuntu-latest
    outputs:
      COMMIT_ID: ${{ steps.build.outputs.COMMIT_ID }}
      IMAGE_ID: ${{ steps.build.outputs.IMAGE_ID }}
    steps:
      - name: Checkout
        uses: actions/checkout@v3
#      - name: Lint
#        run: docker run --rm -i hadolint/hadolint hadolint - < Dockerfile
      - name: Build
        id:   build
        run:  |
          docker build . -t ${GITHUB_REPOSITORY}:${GITHUB_SHA}
          echo "::set-output name=COMMIT_ID::${GITHUB_SHA}"
          echo "::set-output name=IMAGE_ID::${GITHUB_REPOSITORY}:${GITHUB_SHA}"

